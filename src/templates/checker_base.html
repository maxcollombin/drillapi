<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Service Availability Checker</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #fafafa;
  color: #222;
  margin: 0 auto;
  padding: 20px;
  width: 80%;
}
details {
  border: 1px solid #ccc;
  border-radius: 5px;
  margin: 8px 0;
  padding: 8px;
}
summary {
  font-weight: bold;
  cursor: pointer;
}
.success { background-color: #d1e7dd; border-color: #badbcc; }   /* green */
.error   { background-color: #f8d7da; border-color: #f5c2c7; }   /* red */
.warning { background-color: #fff3cd; border-color: #ffecb5; }   /* yellow */
h2 { text-align: center; }
pre {
  white-space: pre-wrap;
  word-break: break-word;
  background: #fff;
  padding: 8px;
  border-radius: 5px;
  overflow-x: auto;
}
a { color: #0056b3; text-decoration: none; }
a:hover { text-decoration: underline; }
</style>
</head>
<body>
  <h2>Service Availability Checker</h2>
  <div id="results">
    {% for result in results %}
      {% if result.status == "success" %}
      <details class="success">
        <summary>✅ {{ result.canton }} - ({{ result.coord_x }}, {{ result.coord_y }})</summary>
        <p><b>Ground Category:</b> {{ result.ground_category or "N/A" }}</p>
        <p><b>WMS URL:</b> <a href="{{ result.wms_url }}" target="_blank">{{ result.wms_url }}</a></p>
        <p><b>Full WMS Call:</b> <a href="{{ result.full_wms_url }}" target="_blank">{{ result.full_wms_url }}</a></p>
        <pre>{{ result.wms_params | tojson(indent=2) }}</pre>
      </details>

      {% elif result.status == "error" %}
      <details class="error">
        <summary>❌ {{ result.canton }} - ({{ result.coord_x }}, {{ result.coord_y }})</summary>
        <pre>{{ result.error | tojson(indent=2) }}</pre>
      </details>

      {% elif result.status == "yellow" %}
      <details class="warning">
        <summary>⚠️ {{ result.canton }} - ({{ result.coord_x }}, {{ result.coord_y }})</summary>
        <p>No features returned.</p>
        <p><b>WMS URL:</b> <a href="{{ result.wms_url }}" target="_blank">{{ result.wms_url }}</a></p>
        <p><b>Full WMS Call:</b> <a href="{{ result.full_wms_url }}" target="_blank">{{ result.full_wms_url }}</a></p>
        <pre>{{ result.wms_params | tojson(indent=2) }}</pre>
      </details>
      {% endif %}
    {% endfor %}
  </div>
</body>
</html>
